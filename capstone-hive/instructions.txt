mvn clean package

java -jar target/capstone-hive-0.0.1-SNAPSHOT-jar-with-dependencies.jar jdbc:hive2://ip-20-0-21-4.ec2.internal:10000/default;ssl=false


java -jar target/capstone-hive-0.0.1-SNAPSHOT-jar-with-dependencies.jar jdbc:hive2://ip-20-0-31-127.ec2.internal:10000/default;ssl=false


java -jar target/capstone-hive-0.0.1-SNAPSHOT-jar-with-dependencies.jar jdbc:hive2://ip-20-0-22-9.ec2.internal:10000/default;ssl=false


!connect jdbc:hive2://ip-20-0-22-9.ec2.internal:10000/default


!connect jdbc:hive2://localhost:10000/default;ssl=false


//https://stackoverflow.com/questions/28898936/beeline-not-able-to-connect-to-hiveserver2


sudo find / -name hive.log

java -cp "capstone-hive-0.0.1-SNAPSHOT.jar:jars/*" com.edureka.capstone.ProblemOne

bin/hive --service hiveserver2 start

select t.merchantid as merchantid, c.gender as gender , MONTH(from_utc_timestamp(t.tx_timestamp,'yyyy-mm-dd hh:mm:ss')) as month, sum(t.invoiceamount) as amount, count(*) as orderCount from transaction t join customer c on t.customerid=c.customerid where YEAR(from_utc_timestamp(tx_timestamp,'yyyy-mm-dd hh:mm:ss'))= 2016 and t.merchantid in(778,503,809,897,509) group by t.merchantid,c.gender,MONTH(from_utc_timestamp(t.tx_timestamp,'yyyy-mm-dd hh:mm:ss')) order by amount desc;



select count(*) from transaction t join customer c on t.customerid=c.customerid ;